<!DOCTYPE html>
<?php
$requestUri = $_SERVER["REQUEST_URI"];
$requestUri = strtok($requestUri, "?");
$basePath = rtrim(dirname($requestUri), "/\\");
?>
<html lang="pt-BR">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Bradesketch</title>
        
        <style>
            html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
                overflow: hidden;
                font-family: Verdana, Geneva, Tahoma, sans-serif;
            }

            body {
                background-color: #FAF9F5;
            }

            #graph-header {
                position: absolute;

                border: 1px solid #CCC;
                box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px, rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;
                color: #787878;

                top: 50px;
                right: 2%;
                margin: 0;
                padding: 10px;

                font-size: 32px;
                font-weight: bold;

                z-index: 300;
            }

            #graph-header h1 {
                font-size: 24px;
                font-weight: bold;
                margin: 0;
                padding: 0;
            }

            #graph-header p {
                font-size: 10px;
                font-weight: normal;
                margin: 0;
                padding: 0;
            }

            #menu {
                position: absolute;

                left: 0;
                top: 0;
                width: 270px;
                height: 100%;
                padding: 10px 0;

                text-align: center;

                background-color: #FAF9F5;

                border-right: 1px solid #CCC;
                z-index: 200;
            }

            #menu h2 {
                font-size: 24px;
                line-height: 24px;
                margin: 10px 0;
                padding: 0;
            }

            #menu.hide {
                display: none;
            }

            #menu > div:first-of-type {
                text-align: right;
                padding: 0 10px;
            }

            #user-panel {
                background-color: #FFFFFF;
                border-top: 1px solid #CCC;
                border-bottom: 1px solid #CCC;
                padding-bottom: 20px;
            }

            #add-node-form {
                display: block;
            }

            #add-node-form.hide {
                display: none;
            }

            #add-edge-form {
                display: none;
            }

            #add-edge-form.show {
                display: block;
            }

            /* Info panel on the right side */

            #info-panel {
                position: absolute;

                right: 0;
                top: 0;

                width: 40%;
                height: 100%;
                
                background-color: #fff;
                border-left: 1px solid #CCC;
                padding: 10px;
                
                display: none;
                z-index: 400;
            }

            #info-panel.show {
                display: block;
            }

            #cy {
                position: absolute;

                left: 0;
                top: 32px;
                bottom: 0;
                right: 0;

                width: 100%;
                height: 100%;
                
                z-index: 100;
            }

            #modal {
                position: absolute;

                border: 2px solid #CCC;
                background-color: #fff;

                left: 25%;
                top: 8%;
                width: 50%;
                height: 70%;

                padding: 10px;

                display: none;
                z-index: 200;
            }

            #modal.show {
                display: block;
            }

            #modal-new-prj {
                display: none;
            }

            #modal-new-prj.show {
                display: block;
            }

            #modal-open-prj {
                display: none;
            }

            #modal-open-prj.show {
                display: block;
            }
        </style>

        <script>
            const basePath = "<?php echo $basePath; ?>";
        </script>
    </head>
    <body>
        <div id="graph-header">
            <h1 id="graph-title">Graph</h1>
            <p>Autor: <span id="graph-author"></span></p>
            <p>Criado em: <span id="graph-created"></span></p>
        </div>
        <div id="menu">
            <div><button id="close-menu-btn">X</button></div>
            <img src="<?php echo $basePath; ?>images/logo.png" alt="Logo" width="32" height="32">
            <h2><span style="color: rgb(182, 43, 43);">Brades</span>ketch</h2>

            <div id="user-panel">
                <p><button id="login-btn" title="Entrar">Entrar</button></p>
                <p>
                    <button id="new-prj-btn" title="Novo Documento" style="margin: 0 10px;">Novo</button>
                    <button id="open-prj-btn" title="Abrir Documento" style="margin: 0 10px;">Abrir</button>
                </p>
            </div>

            <form id="add-node-form" method="post">
                <h3>Adicionar Item</h3>
                <p>
                    <label for="add-node-form-category">Categoria:<br>
                        <select id="add-node-form-category" name="category" required>
                            <option>Selecione</option>
                        </select>
                    </label>
                </p>

                <p>
                    <label for="add-node-form-type">Tipo:<br>
                        <select id="add-node-form-type" name="type" required>
                            <option>Selecione</option>
                        </select>
                    </label>
                </p>

                <p>
                    <label for="add-node-form-node">Item:<br>
                        <select id="add-node-form-node" name="node" required>
                            <!-- Options will be populated dynamically -->
                        </select>
                    </label>
                </p>

                <p><button id="add-node-form-submit" type="submit">Adicionar Item</button></p>
            </form>

            <form id="add-edge-form" method="post">
                <h3>Adicionar Conex찾o</h3>
                <p><button id="add-edge-form-submit" type="submit" disabled>Adicionar Conex찾o</button></p>
            </form>

            <p>
                <button id="export-btn" type="button">Exportar</button>
            </p>

            <p>
                <button id="fit-btn" type="button">Ajustar</button>
            </p>
        </div>

        <div id="info-panel">
            <h2>Propriedades do N처</h2>
            <div id="info-panel-content">
                <p><strong>ID:</strong> <span id="info-node-id"></span></p>
                <p><strong>R처tulo:</strong> <span id="info-node-label"></span></p>
                <p><strong>Categoria:</strong> <span id="info-node-category"></span></p>
                <p><strong>Tipo:</strong> <span id="info-node-type"></span></p>
                <div id="info-node-properties">
                    <!-- Additional properties will be populated dynamically -->
                </div>
            </div>
        </div>

        <div id="modal">
            <div><button id="close-modal-btn">x</button></div>
            <div id="modal-new-prj">
                <div id="modal-new-prj-content">
                    <h2>Novo Projeto</h2>
                    <form id="new-prj-form" method="post">
                        <p><label for="new-prj-form-name">Nome:<br>
                            <input type="text" id="new-prj-form-name" name="name"></label>
                        </p>
                        <p><button type="submit">Criar</button></p>
                    </form>
                </div>
            </div>

            <div id="modal-open-prj">
                <div id="modal-open-prj-content">
                    <h2>Abrir Projeto</h2>
                    <form id="open-prj-form" method="post">
                        <p><label for="open-prj-form-id">Projeto 
                            <select id="open-prj-form-id" name="id">
                            </select>
                        </label></p>
                        <p><button type="submit">Abrir</button></p>
                    </form>
                </div>
            </div>
        </div>
        
        <div id="cy"></div>
    
    <script type="module">
        import { App } from '/javascript/app.js';
        
        document.addEventListener("DOMContentLoaded", async function() {
            const app = new App();
        });
    </script>
    </body>
</html>